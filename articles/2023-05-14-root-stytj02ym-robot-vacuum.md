---
layout: post
title: Root –¥–æ—Å—Ç—É–ø –¥–æ –ø–∏–ª–æ—Å–æ—Å–∞ Xiaomi STYTJ02YM (Viomi V8) Vacuum Robot
permalink: /blog/root-styj02ym-robot-vacuum.html
---

–°—É—á–∞—Å–Ω–∏–π —Ä–æ–±–æ—Ç –ø–∏–ª–æ—Å–æ—Å –æ—Å–Ω–∞—â–µ–Ω–æ –∫–∞–º–µ—Ä–æ—é, —Ä–∞–¥–∞—Ä–æ–º —ñ –±–æ–≥ –∑–Ω–∞ —â–µ —á–∏–º. –ü—Ä–∏ —Ü—å–æ–º—É —É—Å—å–æ–º—É –≤—ñ–Ω –∑–∞–≤–∂–¥–∏ –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç —ñ, —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ, –º–æ–∂–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ —Ä–æ–∑–º–æ–≤–∏, —Ñ–æ—Ç–æ, –∞–¥—Ä–µ—Å–∏ —Ç–∞ –∫–∞—Ä—Ç–∏ –≤–∞—à–∏—Ö –ø–æ–º–µ—à–∫–∞–Ω–Ω—è —è–∫–æ–º—É—Å—å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–º—É –õ—ñ –•—É–∞–Ω –ß–∂–∞–Ω—É. –ê –±–µ—Ä—É—á–∏ –¥–æ —É–≤–∞–≥–∏ —Ç–µ, —â–æ —Å–∫–æ—Ä—ñ—à –∑–∞ –≤—Å–µ, —É –≤–∞—à–æ–º—É –±—É–¥–∏–Ω–∫—É (_—Ç–∞ –π –Ω–∞ –≤–∞—Å —Å–∞–º–∏—Ö —ñ –π–º–æ–≤—ñ—Ä–Ω–æ –Ω–∞ —É—Å—ñ—Ö —á–ª–µ–Ω–∞—Ö –≤–∞—à–æ—ó —Ä–æ–¥–∏–Ω–∏_) –æ–∫—Ä—ñ–º —Ä–æ–±–æ—Ç–∞ –ø–∏–ª–æ—Å–æ—Å–∞ —â–µ –∫—É–ø–∞ —Ä—ñ–∑–Ω–æ—ó —ñ–Ω—à–æ—ó "—Ä–æ–∑—É–º–Ω–æ—ó" —Ç–µ—Ö–Ω—ñ–∫–∏, —Ç–æ –π –∂–µ –õ—ñ –•—É–∞–Ω –ß–∂–∞–Ω, —è–∫—â–æ —Ç–æ–≥–æ –∑–∞—Ö–æ—á–µ, –º–æ–∂–µ –∑–Ω–∞—Ç–∏ –ø—Ä–æ –≤–∞—Å —Å—Ç—ñ–ª—å–∫–∏ –≤—Å—å–æ–≥–æ, —â–æ –≤–∏ –π —Å–∞–º—ñ –ø—Ä–æ —Å–µ–±–µ –Ω–µ –∑–¥–æ–≥–∞–¥—É—î—Ç–µ—Å—å. –°–µ—Ä—Ü–µ–≤–∏–π —Ä–∏—Ç–º, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫–∏—Å–Ω—é —É –∫—Ä–æ–≤—ñ, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –ø–æ–≤—ñ—Ç—Ä—è —ñ –ø—ñ–¥–ª–æ–≥–∏ —É –≤–∞—à–∏—Ö –∫—ñ–º–Ω–∞—Ç–∞—Ö, —è—Å–∫—Ä–∞–≤—ñ—Å—Ç—å –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è... –©–µ —Ç—Ä–æ—Ö–∏ —ñ –≤–æ–Ω–∏ –±—É–¥—É—Ç—å –∑–Ω–∞—Ç–∏ –≤–∞—à –≥–æ—Ä–º–æ–Ω–∞–ª—å–Ω–∏–π —Ñ–æ–Ω. –°—Ç—Ä–∞—à–Ω–µ üò¨

–û—Ç–∂–µ, —á–∞—Å –≤—ñ–¥ —á–∞—Å—É —è –∑–∞–º–∏—Å–ª—é–≤–∞–≤—Å—è –Ω–∞–¥ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—é –≤—ñ–¥–≤ º—è–∑–∞—Ç–∏ —Ä–æ–±–æ—Ç–∞ –ø–∏–ª–æ—Å–æ—Å–∞ –≤—ñ–¥ –∫–∏—Ç–∞–π—Å—å–∫–∏—Ö "—Ö–º–∞—Ä" —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –≤–∏–∫–ª—é—á–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ. –ü—ñ–¥ —á–∞—Å —Ä—ñ—Å—å–æ—Ä—á—É –∑–Ω–∞–π—à–æ–≤ —à—Ç—É–∫—É –ø—ñ–¥ –Ω–∞–∑–≤–æ—é [Valetudo](https://valetudo.cloud/), –∞–ª–µ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–∏–π root –¥–æ—Å—Ç—É–ø –¥–æ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏. –í–ª–∞—Å–Ω–µ –ø—Ä–æ —Ü–µ —ñ –ø–∏—à—É. –ù–∞—Å–ø—Ä–∞–≤–¥—ñ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç–∞—Ö –≤–∂–µ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –Ω–∞ —Ü—é —Ç–µ–º—É. –ê–ª–µ —Ç—É—Ç —è —Å–ø—Ä–æ–±—É–≤–∞–≤ —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ —É—Å–µ –¥–æ –∫—É–ø–∏, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ —Ç–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é.

<!-- more -->

–î–ª—è –ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–∫–∏–¥–∞—î–º–æ –≤–∞—à–æ–≥–æ dust sucker'–∞ –ø—É–∑–æ–º –¥–æ–≥–æ—Ä–∏. –ë–∞—á–∏–º–æ –Ω–∞–∫–ª—î—î—á–∫—É.
![stiker](assets/vacuum-stytj02ym/IMG_20231209_214843.jpg)

–ó–Ω—ñ–º–∞—î–º–æ —Ä–∞–º–∫—É –≥–æ–ª–æ–≤–Ω–æ—ó —â—ñ—Ç–∫–∏, —Å–∞–º—É —â—ñ—Ç–∫—É —ñ –∑–Ω–∞—Ö–æ–¥–∏–º–æ —á–æ—Ç–∏—Ä–∏ –≥–≤–∏–Ω—Ç–∞ —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫—Ä—É—Ç–∏—Ç–∏ –º–∞–ª–æ—é —Ö—Ä–µ—Å—Ç–æ–≤–æ—é –≤–∏–∫—Ä—É—Ç–∫–æ—é.
![screws](assets/vacuum-stytj02ym/IMG_20231209_214652.jpg)

–ó–Ω—ñ–º–∞—î–º–æ –∫—Ä–∏—à–∫—É, –≤–∏—Ç—è–≥–∞—î–º–æ –±–∞—Ç–∞—Ä–µ–π–∫—É, –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ —ó—ó —Ä–æ–∑ º—î–º (1) —ñ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –¥—Ä—ñ—Ç microUSB (2), –∞–ª–µ —â–µ –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –∫–æ–º–ø º—é—Ç–µ—Ä.
![socket](assets/vacuum-stytj02ym/IMG_20231209_214910.jpg)

–°–ø—Ä–∞–≤–∞ –≤ —Ç–æ–º—É, —â–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ [ADB](https://en.wikipedia.org/wiki/Android_Debug_Bridge) —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –¥–µ–≤–∞–π—Å—ñ –º–æ–∂–ª–∏–≤–µ –ª–∏—à–µ –≤–ø—Ä–æ–¥–æ–≤–∂ –æ–¥–Ω—ñ—î—ó-–¥–≤–æ—Ö —Å–µ–∫—É–Ω–¥ –∑ –º–æ–º–µ–Ω—Ç—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —Ä–æ–±–æ—Ç –∑–∞–∫—Ä–∏–≤–∞—î –¥–æ—Å—Ç—É–ø –¥–æ [ADB](https://en.wikipedia.org/wiki/Android_Debug_Bridge). –î–æ —Ç–æ–≥–æ –∂ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ shell –Ω—ñ—á–æ–≥–æ —Ç–æ–±—ñ –Ω–µ –¥–∞—Å—Ç—å —Ç–æ–º—É, —â–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –∞–±–æ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ñ–∞–π–ª `/bin/adb_shell`. –ù–∞—Ä–∞–∑—ñ –≤—ñ–Ω –º–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç:

```sh
#!/bin/sh
export ENV='/etc/adb_profile'
if [ $1 = '-' ];then
	/bin/login
elif [ $1 = '-c' ];then
	/bin/login -c "$2"
else
	/bin/login
fi
```

–º–∏ –ø–æ–≤–∏–Ω–Ω—ñ –∑–∞–º—ñ–Ω–∏—Ç–∏ –π–æ–≥–æ –Ω–∞:

```sh
#!/bin/sh
export ENV='/etc/adb_profile'
exec /bin/sh "$@"
```

–î–ª—è —Ü—å–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î–º–æ —Ñ–∞–π–ª —ñ–∑ –Ω–∞–∑–≤–æ—é `adb_shell` –±—É–¥—å –¥–µ –Ω–∞ –≤–∞—à–æ–º—É –Ω–∞ –∫–æ–º–ø—ñ. –ü–∏—à–µ–º–æ —É –Ω—å–æ–≥–æ –∫–æ–¥ –Ω–∞–¥–∞–Ω–∏–π –≤–∏—â–µ, –∞ —Ç–∞–∫–æ–∂ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –π–æ–º—É execution bits.

```sh
touch adb_shell
chmod +x adb_shell
```

–î–ª—è —Ç–æ–≥–æ —â–æ–± –Ω–µ "—Ç–∏—Ä–∫–∞—Ç–∏" –∫–æ–º–∞–Ω–¥—É `adb push -a adb_shell /bin/adb_shell` —â–æ—Å–µ–∫—É–Ω–¥–Ω–æ –≤—Ä—É—á–Ω—É, –≤–∏–ª–æ–≤–ª—é—é—á–∏ —Ç–æ–π —Å–∞–º–∏–π –º–æ–º–µ–Ω—Ç –∫–æ–ª–∏ –∑ –Ω–∏–º –º–æ–∂–Ω–∞ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏, –ø–∏—à–µ–º–æ –≤ –∫–æ–Ω—Å–æ–ª—ñ –æ—Ç–∞–∫–µ:

```sh
while true; do adb push -a adb_shell /bin/adb_shell | grep -v "no devices"; done
```

—ñ —á–µ–∫–∞—î–º–æ –¥–æ–ø–æ–∫–∏ –Ω–µ –ø–æ–±–∞—á–∏–º–æ –Ω–∞—Å—Ç—É–ø–Ω–µ:

```text
adb_shell: 1 file pushed, 0 skipped. 0.0 MB/s (100 bytes in 0.033s)
```

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∏—Å–º–∏–∫—É—î–º–æ —ñ–∑ —Ä–æ–±–æ—Ç–∞ –¥—Ä—ñ—Ç —ñ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –∑–Ω–æ–≤—É.
–í–∏–∫–æ–Ω—É—î–º–æ –Ω–∞—Å—Ç—É–ø–Ω–µ, —â–æ–± –≤–∏–º–∫–Ω—É—Ç–∏ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å—É, —è–∫–∏–π –Ω–µ –¥–∞—î –Ω–æ—Ä–º–∞–ª—å–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ `adb`.
_NOTE: –°–ø–æ–∫—ñ–π–Ω–æ, —Ü–µ –±–µ–∑–ø–µ—á–Ω–æ —Ç–æ–º—É, —â–æ —Ç—É—Ç –º–∏ –≤–∏–¥–∞–ª—è—î–º–æ —Å—ñ–º–ª—ñ–Ω–∫ –Ω–∞ —Ñ–∞–π–ª –∞ –Ω–µ —Å–∞–º —Ñ–∞–π–ª. –ü–æ—Ç—ñ–º –≤—Å–µ –≤—ñ–¥–Ω–æ–≤–∏–º–æ._

```sh
while true; do (adb shell rm /etc/rc.d/S90robotManager && echo "Done") 2>&1 | grep -v "no devices"; done
```

–ß–µ–∫–∞—î–º–æ –Ω–∞ —É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó (—è–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—å –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ USB —ñ –ø–æ–≤—Ç–æ—Ä—é—î–º —É—Å–µ –∑ –ø–æ—á–∞—Ç–∫—É).
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤–∂–µ –º–æ–∂–Ω–∞ —Å–ø–æ–∫—ñ–π–Ω–æ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `adb shell`. –Ø–∫—â–æ —Ç–∏ –±–∞—á–∏—à —à–æ—Å—å –æ—Ç–∞–∫–µ, —Ç–æ —Ü–µ —É—Å–ø—ñ—Ö.

![Welcome Shell](assets/vacuum-stytj02ym/welcome-shell.jpg)

–¢–µ–ø–µ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ [Dropbear](https://en.wikipedia.org/wiki/Dropbear_(software)) —â–æ–± —É–º–æ–∂–ª–∏–≤–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —á–µ—Ä–µ–∑ [ssh](https://en.wikipedia.org/wiki/Secure_Shell). –ó–≤—ñ—Å–Ω–æ –º–æ–∂–Ω–∞ [–∑—ñ–±—Ä–∞—Ç–∏ –π–æ–≥–æ —ñ–∑ —Å–∏—Ä—Ü—ñ–≤](https://github.com/mkj/dropbear) –∞–ª–µ –ø—Ä–æ—Å—Ç—ñ—à–µ [—Å–∫–∞—á–∞—Ç–∏ –≥–æ—Ç–æ–≤–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–∫](assets/vacuum-stytj02ym/dropbear_2015.71-2_sunxi.ipk) —ñ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ.

```bash
adb push dropbear_2015.71-2_sunxi.ipk /tmp
adb shell opkg install /tmp/dropbear_2015.71-2_sunxi.ipk
adb shell sed -i -e "/PasswordAuth/ s/off/on/g" /etc/config/dropbear
```

- –ø—É—à–∏–º–æ –π–æ–≥–æ –∑ –∫–æ–º–ø–∞ –Ω–∞ –ø–∏–ª–æ—Å–æ—Å
- —ñ–Ω—Å—Ç–∞–ª—é—î–º–æ –Ω–∞ –ø–∏–ª–æ—Å–æ—Å—ñ
- –¥–æ–∑–≤–æ–ª—è—î–º–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ä–æ–ª—è

–í—ñ–¥–∫–ª—é—á–∞—î–º–æ—Å—å –≤—ñ–¥ USB –ø–∏–ª–æ—Å–æ—Å–∞. –¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ –Ω–∞–∑–∞–¥ –π–æ–≥–æ –±–∞—Ç–∞—Ä–µ–π–∫—É, —á–µ–∫–∞—î–º–æ –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ—Å—å –ø–æ ssh.

```sh
ssh root@vacuum.home
```

–î–µ `vacuum.home` - IP –∞–¥—Ä–µ—Å–∞ –≤–∞—à–æ–≥–æ —Ä–æ–±–æ—Ç–∞ —É –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ. –í—ñ–Ω –∑–∞–ø–∏—Ç–∞—î –≤–∞—Å –ø–∞—Ä–æ–ª—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π –æ—Ü–µ `@3I#sc$RD%xm^2S&`. –ù–∞—Å—Ç—É–ø–Ω–æ—é –∫–æ–º–∞–Ω–¥–æ—é –≤–∏–∫–æ–Ω–∞–π:

```sh
passwd
```

–¢–µ–ø–µ—Ä –≤—ñ–Ω –∑–∞–ø–∏—Ç–∞—î —Ç–µ–±–µ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å –¥–≤–∞ —Ä–∞–∑–∏. –î–∞–ª—ñ –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ ssh –∫–ª—é—á `/etc/dropbear/authorized_keys` —è–∫—â–æ —Ö–æ—á–µ—à, –∞–ª–µ —Ç–æ –Ω–µ –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ.

–Ü –æ—Ç —Ç–µ–ø–µ—Ä –º–æ–∂–Ω–∞ "–ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –¥–æ –∂–∏—Ç—Ç—è" –≥–æ–ª–æ–≤–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –ø–∏–ª–æ—Å–æ—Å–∞.

```bash
cd /etc/rc.d
ln -s ../init.d/robotManager S90robotManager
```

–¢–æ–±—Ç–æ —Ç—É—Ç –º–∏ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –Ω–∞–∑–∞–¥ —Å—ñ–º–ª—ñ–Ω–∫—É —è–∫—É –≤–∏–¥–∞–ª–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ.

–í—Å—å–æ, –º–æ–∂–Ω–∞ –∑–±–∏—Ä–∞—Ç–∏ —ñ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç–∞. –¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ —Å–ø–æ–∫—ñ–π–Ω–æ –ø—ñ–¥–∫–ª—é—á–∞—Ç–∏—Å—å –¥–æ –Ω—å–æ–≥–æ –ø–æ ssh —É —Ä–∞–∑—ñ –ø–æ—Ç—Ä–µ–±–∏.

## –î–∂–µ—Ä–µ–ª–∞

- https://itooktheredpill.irgendwo.org/2020/rooting-xiaomi-vacuum-robot/
- https://blog.lupin.rocks/fixing-xiaomi-styj02ym-update-stuck-on-80/
- https://github.com/rumpeltux/viomi-rooting
- https://github.com/rumpeltux/viomi-rooting/blob/master/viomi-root.sh#L208
